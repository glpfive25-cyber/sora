# 角色功能使用指南

## 🎭 新增功能

根据您提供的 API 文档，我已成功为 Sora2 Plus 项目添加了以下角色相关功能：

### 1. 角色创建功能
- **位置**：侧边栏 → 角色工具 → 创建角色
- **功能**：从视频创建可重复使用的角色
- **要求**：视频中不能出现真人

### 2. 角色视频生成
- **位置**：侧边栏 → 角色工具 → 角色视频
- **功能**：使用创建的角色生成新视频
- **支持**：多种模型、时长、方向选择

### 3. 我的角色列表
- **位置**：侧边栏 → 角色工具 → 我的角色
- **功能**：查看所有已创建的角色
- **管理**：角色信息展示、历史记录

## 🚀 使用步骤

### 第一步：创建角色

1. **上传角色视频**
   - 点击"创建角色"标签
   - 上传包含角色的视频文件（MP4, AVI, MOV）
   - 视频中一定不能出现真人，否则会失败

2. **设置时间范围**
   - 设置角色出现的时间范围
   - 时间差值必须在 1-3 秒之间
   - 例如：开始 1秒，结束 3秒

3. **创建角色**
   - 点击"创建角色"按钮
   - 等待角色创建完成
   - 成功后会显示角色信息（ID、用户名、头像等）

### 第二步：生成角色视频

1. **选择角色**
   - 在"角色视频"页面
   - 从下拉菜单选择已创建的角色
   - 或直接在描述中输入 @username

2. **输入描述**
   - 描述您想要的视频内容
   - 可以包含角色相关的描述

3. **配置参数**
   - **模型**：Sora-2 (标准) 或 Sora-2 Pro (高级)
   - **方向**：横屏或竖屏
   - **时长**：10秒、15秒或25秒（仅Pro）
   - **质量**：高清或一般

4. **生成视频**
   - 点击"生成角色视频"按钮
   - 观察实时进度条
   - 等待生成完成

### 第三步：管理角色

1. **查看角色列表**
   - 访问"我的角色"页面
   - 查看所有已创建的角色
   - 显示角色头像、用户名、ID等信息

2. **角色信息**
   - 点击"查看主页"访问角色页面
   - 查看角色创建时间
   - 查看角色时间范围设置

## 📋 API 接口说明

### 创建角色接口
- **端点**：`POST /api/character/create`
- **参数**：
  - `videoUrl`: 视频文件URL
  - `timestamps`: 时间范围，格式 "1,3"

### 带角色视频生成接口
- **端点**：`POST /api/video/create-with-character`
- **参数**：
  - `prompt`: 视频描述
  - `model`: 模型选择（sora-2, sora-2-pro）
  - `size`: 质量（large, small）
  - `orientation`: 方向（landscape, portrait）
  - `duration`: 时长（10, 15, 25）
  - `character_url`: 角色视频URL（可选）
  - `character_timestamps`: 角色时间戳（可选）

### 任务状态查询接口
- **端点**：`GET /api/video/tasks/:taskId`
- **功能**：查询视频生成任务状态

## 🛠️ 技术实现

### 后端更新
1. **sora2.js** - 添加角色相关API方法
2. **server.js** - 添加角色管理路由和视频上传功能

### 前端更新
1. **index.html** - 添加角色管理界面
2. **app.js** - 添加角色功能JavaScript逻辑

### 数据存储
- 角色信息保存在浏览器 localStorage 中
- 支持角色历史记录管理
- 自动同步角色选择下拉菜单

## ⚠️ 注意事项

1. **真人限制**
   - 角色视频中不能出现真人
   - 违规会导致创建失败

2. **时间范围**
   - 角色出现时间范围：1-3秒
   - 请精确设置时间戳

3. **文件格式**
   - 支持常见视频格式（MP4, AVI, MOV）
   - 文件大小限制：50MB

4. **模型选择**
   - 25秒时长仅支持 Sora-2 Pro
   - 根据需求选择合适的模型

5. **进度监控**
   - 角色视频生成支持实时进度显示
   - 会显示任务ID和预计时间

## 🎯 使用建议

1. **首次使用**
   - 先创建简单的角色进行测试
   - 熟悉时间范围设置

2. **角色选择**
   - 选择清晰、无真人的视频片段
   - 确保角色特征明显

3. **描述优化**
   - 详细描述视频内容
   - 包含角色相关的动作描述

4. **参数配置**
   - 根据需求选择合适时长和质量
   - 长时间视频生成需要更多等待

---

## 📞 技术支持

如有问题，请检查：
1. 浏览器控制台错误信息
2. 服务器运行状态
3. API 密钥配置是否正确

功能已完全集成到现有系统中，可以正常使用！